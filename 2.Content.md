# 2. Content

The elements of a pentest report seem concrete, but every part has subtleties that make it work. Let's take a tour of them with examples and pointers.

A pentest report needs at least:

* A title page.
* Assessment details.
* Findings, if any.
* A conclusion or management summary.

## 2.1. Title page

The title page helps readers quickly figure out what the document is about. It should still make sense when someone finds your report on a share three years from now. We can achieve this by stating:
* That it is a pentest report.
* The subject of the pentest.
* The date or version.
* The pentest company with a logo and/or the author.

## 2.2. Assessment details

The assessment details describe the context of the pentest. A reader without knowledge of the pentest should be able to understand the setup. I generally find it helpful to provide:
* The start and stop dates of the assessment.
* The scope, meaning the components of the subject that the pentest focused on.
* Type of assessment and provided materials. This helps the reader know if you looked at the code, used certain accounts, etc.
* The goal or objective of the client, if specified. Examples are research questions or testing a certain type of attack.
* Limitations of the pentest, like when certain tests couldn't be performed. Limited functionality in a test environment is quite common. It is good to make a note of it to inform the client on testing blind spots.

## 2.3. Conclusion

Start with a paragraph that introduces the conclusion. This paragraph can include a general summary of the results. For example: "_[Pentest Company] performed a pentest on [Application] between [date] and [date]. The application currently has a weak security posture. Two high-risk vulnerabilities allow attackers to exfiltrate customer data without requiring authentication._"

The next few paragraphs describe the results from the story. Don't just make a list of findings. but write about overlapping themes. High-risk vulnerabilities can get their own paragraph if they are not related. Leave out low-risk vulnerabilities if they don't add to the most important themes.

End the conclusion with a paragraph that reads like a closing statement. Common formulas are: recommending to fix and retest the vulnerabilities; recommending sharing the security knowledge in the development team; recommending a structural solution to the security challenges.

## 2.4. The order of findings

List findings from high-risk to low-risk. It might seem to counteract Act II of the three-act structure, where tension is built from low to high, but remember that additional findings will still build up tension, and that the climax exists in the conclusion.

Complementary findings with the same risk rating should be put next to each other. For example, a finding that reads an impact description like "_to exploit this vulnerability, an attacker would need to know x_" can be followed up by a finding that reads "_Stack traces leak x_", to show that this leak is possible while its impact is still fresh in memory. You can later use this as a theme in the conclusion to bring the point home.

## 2.5. A Finding

The story line of a finding is generally as follows: We must introduce an application’s happy flow, followed by the vulnerability to show some kind of conflict. The story peaks in the exploit and the impact description, and tension is resolved in the recommendation.

Before we start with the finding's details we'll create a heading with a proper name and risk rating.

### 2.5.1. Naming a finding

The ideal finding name describes risk and context. Don't just write "_SQL-Injection_". Better are "_SQL-Injection in [customer page]_", "_Public API vulnerable to SQL-Injection_" or "_SQL-Injection allows Code Execution_". The art here is to make the title speak to the imagination without making it too long.

### 2.5.2. Estimating risk

The formula `Risk = chance * impact` seems trivial but risk ratings differ per pentester. Calculations depend on security philosophy and view of the scope. Whatever your security philosophy, be consistent per report, and communicate your approach on risk analysis. In the end the client decides which business risks the findings pose; you are just providing estimates. 

It might not be your job to tell clients their business risk, but the integrity of your report remains yours to protect. It is not uncommon for companies to try and downplay risks. These risks are calculated from your professional view point. They should only be changed when the client provides valid arguments. Examples of valid arguments are: that it is a false positive; that mitigating measures exist that you were unaware of; that you misinterpreted the function of data.

### 2.4.1. Finding details

Introduce the finding with a summary of the finding and the impact. This can be easily done in three sentences. Start with the happy flow, like "_Users from the Foo application can perform Bar to keep track of their stats_". We then jump to the twist: "_The database queries use input from Bar, but they do not apply the proper encoding to protect against SQL-Injection_". A quick summary of impact can be used to close the introductory paragraph: "_An attacker can inject arbitrary queries to obtain or modify all customer data_".

Now we can start discussing technical details. This part is meant for developers and pentesters. Guide the reader into understanding the vulnerability with code snippets, HTTP responses, etc, in logical order. A developer should be able to understand it, and a pentester should be able to reproduce it. Ideally both are able to reproduce it, but you can’t always make this work. Always provide a proof of some kind. A screenshot is the most common form of proof and it works great.

### 2.4.2 Code snippets

Make code snippets readable and understandable. Include a code path if it is available, and cut out the parts that are unimportant. I like to explain the code in the paragraph that comes before it. For example: "_The code snippet below shows that the account controller will grant the user all roles if the ID parameter has the value 1234._"

_src/controllers/accountHandler.java_
```
public Foo(UserContext user, int ID) {
  [..]
  if (ID == 1234) { grantAllRoles(user); }
```

### 2.4.3. Screenshots

Make sure that your screenshots are properly readable and not too big. Like with code snippets, the reader should have just read a sentence or paragraph that explains what the screenshot is about, like "_The following screenshot shows that the tool successfully decrypted the ciphertext_". Ideally you add a caption – like "_Tool successfully decrypting the ciphertext_" – but this ability depends on the reporting tool you’re using.

Put a border around screenshots with a white background, if the background of your report is white. Also consider making screenshots a bit transparent if the contrast with the rest of the page is too harsh.  

### 2.4.4. Impact description

Start with a sentence that summarizes the finding details, and build from that. We’ll take the example "_An authenticated attacker can use the Bar field of the Foo application to execute arbitrary SQL queries in the database_". Now summarize the abilities of the attacker, e.g. "_Arbitrary SQL queries allow the attacker to insert, modify and delete all data_". Note that this sentence is required for the less technical, since they don’t always know what SQL queries are. Elaborate by explaining the type of data: "_the data includes customer PII and financial records_". A great way to finish the climax of the story is a business risk like "_Extraction of such data is considered a data breach according to the GDPR and can result in large fines_".

Remember that every paragraph communicates a unique idea. If you’d like to highlight an additional risk, make a new paragraph. In the case of SQL injection, you could create a paragraph on the risk of code execution that can results from such a vulnerability.

If there are any mitigating measures in place that limit the risk of the vulnerability, it is best to put it at the end of the impact description. Note that this is in-line with the story structure. The story just reached its peak, and we’re now working towards the release of tension.

### 2.4.5. Recommendation

Don’t start a recommendation with "_We recommend_" or "_It is recommended to_". The heading Recommendation makes these texts redundant. Make an action statement like "_Prevent brute-force attacks on 2FA codes by such and such_".

Provide short and long term advise if required. For example, let’s say we have a vulnerable file upload function, where the ideal solution requires refactoring and design adjustments. Provide a short term solution for a quick patch, and a recommendation to change the file upload design in the long term.

Make sure your further reading links are easy to process. NIST provides awesome standards for information security, but their documents are lengthy. Sources like OWASP copy NIST in a summarized format, which is why I prefer to link to OWASP, especially to their [Cheat Sheet series](https://cheatsheetseries.owasp.org/).

## 2.5. Dos and don'ts

### 2.5.1. Dos

* Be consistent with the way you write terms, like _SQL-Injection_ or _JavaScript_. I like to use OWASP as a reference.
* Try to stay objective and steer away from personal opinion. It is impossible to be purely objective when describing something like the security posture of an application. One trick is to change a statement to a recommendation, like "_We recommend not taking it into production until .._" as opposed to "_It is not production-ready_".
* Do your homework and check if your recommendations are feasible. If you encounter hardcoded secrets, and you say "_Encrypt these secrets_", do check the documentation if this is even possible, or you'll leave the developer hanging.
* Use a spell checker.
* Make sure your report is done before sending it to peers for review. A review is like a pentest; its purpose is to check for things you missed, not to do the work for you.
* Review it yourself at least two times before sending it in for review. This means reading the entire thing from the title page to the conclusion.

### 2.5.2. Don'ts

* Try to avoid one-sentence finding details, impact descriptions or recommendations for anything higher than low-risk.
* Don't use slang like _info_ or _admin_, but use _information_ and _administrator_.